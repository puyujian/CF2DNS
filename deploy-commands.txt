# CF2DNS 部署命令清单
# 请按顺序执行以下命令

# 1. 登录 Cloudflare 账户
wrangler auth login

# 2. 创建 D1 数据库
wrangler d1 create cf2dns-db

# 3. 创建预览环境数据库
wrangler d1 create cf2dns-db-preview

# 4. 创建生产环境数据库
wrangler d1 create cf2dns-db-prod

# 5. 创建 KV 命名空间
wrangler kv:namespace create "SESSIONS"

# 6. 创建预览环境 KV 命名空间
wrangler kv:namespace create "SESSIONS" --preview

# 7. 创建生产环境 KV 命名空间
wrangler kv:namespace create "SESSIONS" --env production

# 8. 应用数据库迁移到本地（测试）
wrangler d1 migrations apply cf2dns-db --local

# 9. 应用数据库迁移到远程
wrangler d1 migrations apply cf2dns-db

# 10. 构建项目
npm run build

# 11. 部署到预览环境
wrangler deploy --env preview

# 12. 部署到生产环境（确认预览环境正常后）
wrangler deploy --env production

# 注意：执行命令2-7后，需要将返回的ID更新到 wrangler.toml 文件中对应的占位符位置
